title: "Penguin Analysis"
install.packages("patchwork")
library(tidyverse)
library(patchwork)
title: "Penguin Analysis"
# Use the function in functions.R
p1 <- create_scatterplot(data, "Adelie", "#6689c6")
p2 <- create_scatterplot(data, "Chinstrap", "#e85252")
p3 <- create_scatterplot(data, "Gentoo", "#9a6fb0")
p1 + p2 + p3
# Use the function in functions.R
p1 <- create_scatterplot(data, "Adelie", "#6689c6")
p2 <- create_scatterplot(data, "Chinstrap", "#e85252")
p3 <- create_scatterplot(data, "Gentoo", "#9a6fb0")
# Les combiner côte à côte avec patchwork
plot1 + plot2 + plot3 +
plot_annotation(
caption = "Source : Données Palmer Penguins - Analyse des relations entre différentes mesures morphologiques"
)
# Use the function in functions.R
p1 <- create_scatterplot(data, "Adelie", "#6689c6")
p2 <- create_scatterplot(data, "Chinstrap", "#e85252")
p3 <- create_scatterplot(data, "Gentoo", "#9a6fb0")
# Les combiner côte à côte avec patchwork
p1 + p2 + p3 +
plot_annotation(
caption = "Source : Données Palmer Penguins - Analyse des relations entre différentes mesures morphologiques"
)
# Use the function in functions.R
create_scatterplot(data, "Adelie", "Torgersen")
# Use the function in functions.R
p1 <- create_scatterplot(data, "Adelie", "#6689c6")
p2 <- create_scatterplot(data, "Chinstrap", "#e85252")
p3 <- create_scatterplot(data, "Gentoo", "#9a6fb0")
# Les combiner côte à côte avec patchwork
p1 + p2 + p3 +
plot_annotation(
caption = "Source : Données Palmer Penguins - Analyse des relations entre différentes mesures morphologiques"
)
create_scatterplot <- function(data, selected_species, selected_island) {
# Filter the data for the specified species and island
filtered_data <- data %>%
na.omit() %>%
filter(species == selected_species, island == selected_island)
# Create the scatterplot
plot <- ggplot(
filtered_data,
aes(x = bill_length_mm, y = bill_depth_mm, color = species, shape = species)
) +
geom_point() +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = paste("Penguin Bill Dimensions -", selected_species, "-", selected_island)
)
return(plot)
}
# Use the function in functions.R
p1 <- create_scatterplot(data, "Adelie", "#6689c6")
p2 <- create_scatterplot(data, "Chinstrap", "#e85252")
p3 <- create_scatterplot(data, "Gentoo", "#9a6fb0")
# Les combiner côte à côte avec patchwork
p1 + p2 + p3 +
plot_annotation(
caption = "Source : Données Palmer Penguins - Analyse des relations entre différentes mesures morphologiques"
)
# Summary
summary(data)
#| layout-ncol: 2
data %>%
group_by(species) %>%
summarise(average_bill_length = mean(bill_length_mm, na.rm = TRUE))
data %>%
group_by(species) %>%
summarise(average_bill_depth = mean(bill_depth_mm, na.rm = TRUE))
library(tidyverse)
library(patchwork)
source("R/functions.R")
source("functions.R")
data <- readRDS("input/clean_data.rds")
# Source functions
source(file="functions.R")
# Read the clean dataset
data <- readRDS(file = "../input/clean_data.rds")
# Source functions
source(file="functions.R")
# Read the clean dataset
data <- readRDS(file = "../input/clean_data.rds")
```{r, warning=FALSE, fig.height=3, fig.width=9, fig.cap="There is actually a positive correlation when split by species."}
# Use the function in functions.R
p1 <- create_scatterplot(data, "Adelie", "#6689c6")
p2 <- create_scatterplot(data, "Chinstrap", "#e85252")
p3 <- create_scatterplot(data, "Gentoo", "#9a6fb0")
p1 + p2 + p3
# Use the function in functions.R
p1 <- create_scatterplot(data, "Adelie", "#6689c6")
p2 <- create_scatterplot(data, "Chinstrap", "#e85252")
p3 <- create_scatterplot(data, "Gentoo", "#9a6fb0")
p1 + p2 + p3
# Use the function in functions.R
create_scatterplot(data, "Adelie", "Torgersen")
# Use the function in functions.R
p1 <- create_scatterplot(data, "Adelie", "#6689c6")
p2 <- create_scatterplot(data, "Chinstrap", "#e85252")
p3 <- create_scatterplot(data, "Gentoo", "#9a6fb0")
p1 + p2 + p3
create_scatterplot <- function(data, selected_species, color) {
# Filter the data for the specified species and island
filtered_data <- data %>%
na.omit() %>%
filter(species == selected_species)
# Create the scatterplot
plot <- ggplot(
filtered_data,
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color=color) +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = selected_species
) +
theme(legend.position = "none")
return(plot)
}
# Use the function in functions.R
p1 <- create_scatterplot(data, "Adelie", "#6689c6")
p2 <- create_scatterplot(data, "Chinstrap", "#e85252")
p3 <- create_scatterplot(data, "Gentoo", "#9a6fb0")
p1 + p2 + p3
# Use the function in functions.R
create_scatterplot(data, "Adelie", "Torgersen")
data %>%
ggplot(
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color="#69b3a2") +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = paste("Surprising relationship?")
) +
theme_ipsum()
library(tidyverse)
library(patchwork)
library(hrbrthemes)
install.packages("hrbrthemes")
library(tidyverse)
library(patchwork)
library(hrbrthemes)
install.packages("hrbrthemes")
data %>%
ggplot(
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color="#69b3a2") +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = paste("Surprising relationship?")
)
data %>%
ggplot(
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color="#69b3a2") +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = paste("Surprising relationship?")
) +
theme_ipsum()
data %>%
ggplot(
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color="#69b3a2") +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = paste("Surprising relationship?")
)
library(tidyverse)
library(patchwork)
data %>%
ggplot(
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color="#69b3a2") +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = paste("Surprising relationship?")
)
data %>%
ggplot(
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color="#69b3a2") +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = paste("Surprising relationship?")
)
library(tidyverse)
library(patchwork)
library(DT)
# Load library and example dataset:
library(DT)
data(iris)
# Make a table
datatable(iris, filter = "top")
library(tidyverse)
library(patchwork)
library(DT)
library(knitr)
#| layout-ncol: 2
data %>%
group_by(species) %>%
summarise(average_bill_length = mean(bill_length_mm, na.rm = TRUE))
data %>%
group_by(species) %>%
summarise(average_bill_depth = mean(bill_depth_mm, na.rm = TRUE))
data %>%
group_by(species) %>%
summarise(average_bill_depth = mean(bill_depth_mm, na.rm = TRUE))
# Compute some result
bill_length_per_specie <- data %>% group_by(species) %>%
summarise(average_bill_length = mean(bill_length_mm, na.rm = TRUE))
# Display in the Quarto report
kable(bill_length_per_specie)
# Make a table
datatable(data, filter = "top")
#| layout-ncol: 2
graph1<-data %>%
group_by(species) %>%
summarise(average_bill_length = mean(bill_length_mm, na.rm = TRUE))
graph2<-data %>%
group_by(species) %>%
summarise(average_bill_depth = mean(bill_depth_mm, na.rm = TRUE))
kable(graph1,graph2)
#| layout-ncol: 2
graph1<-data %>%
group_by(species) %>%
summarise(average_bill_length = mean(bill_length_mm, na.rm = TRUE))
graph2<-data %>%
group_by(species) %>%
summarise(average_bill_depth = mean(bill_depth_mm, na.rm = TRUE))
kable(graph1)
#| layout-ncol: 2
graph1<-data %>%
group_by(species) %>%
summarise(average_bill_length = mean(bill_length_mm, na.rm = TRUE))
kable(graph1)
graph2<-data %>%
group_by(species) %>%
summarise(average_bill_depth = mean(bill_depth_mm, na.rm = TRUE))
kable(graph2)
library(tidyverse)
library(patchwork)
library(DT)
library(knitr)
library(plotly)
library(ggplot2)
library(gapminder)
p <- gapminder %>%
filter(year==1977) %>%
ggplot( aes(gdpPercap, lifeExp, size = pop, color=continent)) +
geom_point() +
theme_bw()
library(ggplot2)
library(gapminder)
p <- gapminder %>%
filter(year==1977) %>%
ggplot( aes(gdpPercap, lifeExp, size = pop, color=continent)) +
geom_point() +
theme_bw()
p
ggplotly(p)
p
data %>%
ggplot(
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color="#69b3a2") +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = paste("Surprising relationship?")
)
surpising_relation <- data %>%
ggplot(
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color="#69b3a2") +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = paste("Surprising relationship?")
)
ggplotly(surpising_relation)
surpising_relation
# Make a table
datatable(data, filter = "top")
surpising_relation <- data %>%
ggplot(
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color="#69b3a2") +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = paste("Surprising relationship?")
)
ggplotly(surpising_relation)
#| layout-ncol: 2
graph1<-data %>%
group_by(species) %>%
summarise(average_bill_length = mean(bill_length_mm, na.rm = TRUE))
kable(graph1)
graph2<-data %>%
group_by(species) %>%
summarise(average_bill_depth = mean(bill_depth_mm, na.rm = TRUE))
kable(graph2)
# Use the function in functions.R
p1 <- create_scatterplot(data, "Adelie", "#6689c6")
p2 <- create_scatterplot(data, "Chinstrap", "#e85252")
p3 <- create_scatterplot(data, "Gentoo", "#9a6fb0")
p1 + p2 + p3
surpising_relation <- data %>%
ggplot(
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color="#69b3a2") jokkoo_theme() +
surpising_relation <- data %>%
ggplot(
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color="#69b3a2")+
jokkoo_theme() +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = paste("Surprising relationship?")
)
create_scatterplot <- function(data, selected_species, color) {
# Filter the data for the specified species and island
filtered_data <- data %>%
na.omit() %>%
filter(species == selected_species)
# Create the scatterplot
plot <- ggplot(
filtered_data,
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color=color) +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = selected_species
) +
theme(legend.position = "none")
return(plot)
}
# ============================================
# THÈME JOKKOO CONSEIL
# Thème ggplot2 pour analyses d'influence et plaidoyer
# ============================================
jokkoo_theme <- function(base_size = 11) {
theme_minimal(base_size = base_size) +
theme(
# Titre principal
plot.title = element_text(
color = "#1a3a52",        # Bleu profond professionnel
size = 16,
face = "bold",
hjust = 0,
margin = margin(b = 10)
),
# Sous-titre
plot.subtitle = element_text(
color = "#546e7a",
size = 12,
hjust = 0,
margin = margin(b = 15)
),
# Légende
plot.caption = element_text(
color = "#7f8c8d",
size = 8,
hjust = 1,
face = "italic",
margin = margin(t = 10)
),
# Axes
axis.title = element_text(
color = "#2c3e50",
size = 10,
face = "bold"
),
axis.text.x = element_text(
color = "#546e7a",
size = 9,
margin = margin(t = 5)
),
axis.text.y = element_text(
color = "#546e7a",
size = 9,
margin = margin(r = 5)
),
# Grille
panel.grid.major = element_line(
color = "#ecf0f1",
size = 0.4
),
panel.grid.minor = element_blank(),
# Fond
panel.background = element_rect(
fill = "white",
color = NA
),
plot.background = element_rect(
fill = "white",
color = NA
),
# Légende
legend.title = element_text(
color = "#2c3e50",
size = 10,
face = "bold"
),
legend.text = element_text(
color = "#546e7a",
size = 9
),
legend.position = "bottom",
legend.background = element_rect(
fill = "white",
color = NA
),
# Marges
plot.margin = margin(15, 15, 15, 15)
)
}
# ============================================
# PALETTE DE COULEURS JOKKOO CONSEIL
# ============================================
# Palette principale (influence & plaidoyer)
jokkoo_colors <- c(
primary   = "#1a3a52",  # Bleu profond - Confiance, expertise
secondary = "#c97a3a",  # Terracotta - Afrique, chaleur
accent    = "#2e7d6e",  # Vert sapin - Durabilité, commerce équitable
neutral   = "#546e7a",  # Gris ardoise - Neutralité, analyse
light     = "#ecf0f1",  # Gris très clair - Arrière-plans
highlight = "#e8a75d"   # Orange doux - Points d'attention
)
# Fonction pour accéder aux couleurs
jokkoo_pal <- function(name = NULL) {
if (is.null(name)) {
return(jokkoo_colors)
}
jokkoo_colors[name]
}
# Palette discrète pour catégories (maximum 6)
scale_color_jokkoo <- function(...) {
discrete_scale(
"colour", "jokkoo",
manual_pal(unname(jokkoo_colors[c("primary", "accent", "secondary",
"highlight", "neutral", "light")])),
...
)
}
scale_fill_jokkoo <- function(...) {
discrete_scale(
"fill", "jokkoo",
manual_pal(unname(jokkoo_colors[c("primary", "accent", "secondary",
"highlight", "neutral", "light")])),
...
)
}
# Palette continue (pour valeurs numériques)
scale_color_jokkoo_c <- function(...) {
scale_color_gradient(
low = jokkoo_colors["light"],
high = jokkoo_colors["primary"],
...
)
}
scale_fill_jokkoo_c <- function(...) {
scale_fill_gradient(
low = jokkoo_colors["light"],
high = jokkoo_colors["primary"],
...
)
}
surpising_relation <- data %>%
ggplot(
aes(x = bill_length_mm, y = bill_depth_mm)
) +
geom_point(color="#69b3a2")+
jokkoo_theme() +
labs(
x = "Bill Length (mm)",
y = "Bill Depth (mm)",
title = paste("Surprising relationship?")
)
ggplotly(surpising_relation)
# Use the function in functions.R
p1 <- create_scatterplot(data, "Adelie", jokkoo_pal("primary"))
p2 <- create_scatterplot(data, "Chinstrap", jokkoo_pal("accent"))
p3 <- create_scatterplot(data, "Gentoo", jokkoo_pal("secondary"))
p1 + p2 + p3
